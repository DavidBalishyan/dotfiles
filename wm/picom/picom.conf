backend = "glx";              # Use OpenGL backend for better performance
vsync = true;                 # Prevent screen tearing
unredir-if-possible = true;   # Stop compositing when fullscreen to reduce lag

# ─ Shadows ───────────────────
shadow = true;
shadow-radius = 10;
shadow-offset-x = -8;
shadow-offset-y = -8;
shadow-opacity = 0.5;
shadow-exclude = [
  "name = 'Notification'",
  "class_g = 'Conky'",
  "class_g ?= 'Notify-osd'",
  "class_g = 'i3-frame'"
];

# ─ Transparency / Fading ─────
fading = true;
fade-delta = 5;
fade-in-step = 0.03;
fade-out-step = 0.03;

# Inactive window transparency
inactive-opacity = 0.9;
active-opacity = 1.0;
frame-opacity = 1.0;
inactive-opacity-override = false;

# ─ Corners ────────────────────
corner-radius = 8.0;
rounded-corners-exclude = [
  "class_g = 'Polybar'",
  "class_g = 'i3bar'",
  "window_type = 'dock'"
];

# ─ Blur ───────────────────────
blur-method = "dual_kawase";
blur-size = 8;
blur-strength = 7;
blur-background = true;
blur-background-exclude = [
  "window_type = 'dock'",
  "window_type = 'desktop'",
];

# ─ General performance ────────
use-damage = true;
experimental-backends = true;

# ─ Window rules ───────────────
opacity-rule = [
  "85:class_g = 'URxvt'",
  "90:class_g = 'kitty'",
  "100:class_g = 'wezterm'",
  # "90:class_g = 'zen'",
];

# Exclude Polybar from ALL effects
rules = (
  {
    match = "class_g = 'Polybar'";
    shadow = false;
    fade = false;
    blur-background = false;
    opacity = 1.0;
    animations = false;
    corner-radius = 0;
  }
);

